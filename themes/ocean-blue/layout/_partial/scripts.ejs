<!-- Theme JavaScript -->
<%- js('js/main') %>

<% if (theme.custom_js) { %>
  <script><%- theme.custom_js %></script>
<% } %>

<!-- Math Support -->
<% if (theme.math && theme.math.enable && theme.math.engine === 'katex') { %>
  <script defer src="<%- theme.math.katex.js %>"></script>
  <script defer src="<%- theme.math.katex.auto_render %>"></script>
  <script defer>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          <% theme.math.katex.options.delimiters.forEach(function(delimiter, index) { %>
            {left: "<%- delimiter.left %>", right: "<%- delimiter.right %>", display: <%- delimiter.display %>}<% if (index < theme.math.katex.options.delimiters.length - 1) { %>,<% } %>
          <% }) %>
        ],
        throwOnError: false,
        errorColor: "#cc0000"
      });
    });
  </script>
<% } %>

<!-- Analytics -->
<% if (theme.analytics.google) { %>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=<%- theme.analytics.google %>"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '<%- theme.analytics.google %>');
  </script>
<% } %>

<% if (theme.analytics.baidu) { %>
  <!-- Baidu Analytics -->
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?<%- theme.analytics.baidu %>";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
<% } %>
